CREATE SCHEMA `testtask` DEFAULT CHARACTER SET utf8mb4 ;

CREATE TABLE `testtask`.`users` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `firstname` VARCHAR(50) NOT NULL,
  `lastname` VARCHAR(50) NOT NULL,
  `fathername` VARCHAR(52) NULL,
  `login` VARCHAR(30) NOT NULL,
  `pwd` VARCHAR(64) NOT NULL,
  `position` TINYINT(1) NULL,
  PRIMARY KEY (`id`));

CREATE TABLE `testtask`.`tasks` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `title` VARCHAR(125) NOT NULL,
  `description` VARCHAR(500) NULL,
  `date_up` DATE NULL,
  `date_st` DATE NOT NULL,
  `date_end` DATE NULL,
  `priority` INT NOT NULL,
  `status` INT NOT NULL,
  `creator` INT NOT NULL,
  `performer` INT NOT NULL,
  PRIMARY KEY (`id`));

ALTER TABLE `tasks`
ADD CONSTRAINT `creator_fk` FOREIGN KEY (`creator`)
REFERENCES `users`(`id`)
ON UPDATE CASCADE
ON DELETE RESTRICT;

ALTER TABLE `tasks`
ADD CONSTRAINT `performer_fk` FOREIGN KEY (`performer`)
REFERENCES `users`(`id`)
ON UPDATE CASCADE
ON DELETE RESTRICT;

CREATE TABLE `testtask`.`prioritys` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `prior_name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`));

CREATE TABLE `testtask`.`statuses` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `stat_name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`));

ALTER TABLE `tasks`
ADD CONSTRAINT `priority_fk` FOREIGN KEY (`priority`)
REFERENCES `prioritys`(`id`)
ON UPDATE CASCADE
ON DELETE RESTRICT;

ALTER TABLE `tasks`
ADD CONSTRAINT `status_fk` FOREIGN KEY (`status`)
REFERENCES `statuses`(`id`)
ON UPDATE CASCADE
ON DELETE RESTRICT;

